<?xml version="1.0" encoding="UTF-8" ?>
<!--  
    For information on how to customize this file, please see
    http://wiki.apache.org/solr/SolrConfigXml. The page also has a link to 
    an extensively commented version of this file. 
-->
<config>
<!-- Admin Handlers - This will register all the standard admin RequestHandlers. -->

  <luceneMatchVersion>LUCENE_40</luceneMatchVersion>
  <abortOnConfigurationError>${solr.abortOnConfigurationError:true}</abortOnConfigurationError>
  
  <!-- lib directives can be used to instruct Solr to load an Jars identified
       and use them to resolve any "plugins" specified in your solrconfig.xml or
       schema.xml (ie: Analyzers, Request Handlers, etc...).

       All directories and paths are resolved relative the instanceDir.

       If a "./lib" directory exists in your instanceDir, all files found in it
       are included as if you had used the following syntax...

              <lib dir="./lib" />
    -->
  <!-- A dir option by itself adds any files found in the directory to the
       classpath, this is useful for including all jars in a directory.
    -->
  <!-- <lib dir="../../contrib/extraction/lib" /> -->
  <!-- When a regex is specified in addition to a directory, only the files in that
       directory which completely match the regex (anchored on both ends)
       will be included.
    -->
  <!-- <lib dir="../../dist/" regex="apache-solr-cell-\d.*\.jar" /> -->
  <!-- <lib dir="../../dist/" regex="apache-solr-clustering-\d.*\.jar" /> -->
  <!-- If a dir option (with or without a regex) is used and nothing is found
       that matches, it will be ignored
    -->
  <!-- <lib dir="../../contrib/clustering/lib/downloads/" /> -->
  
  <dataDir>${solr.data.dir:}</dataDir>


 <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       Index Config - These settings control low-level behavior of indexing
       Most example settings here show the default value, but are commented
       out, to more easily see where customizations have been made.
       
       Note: This replaces <indexDefaults> and <mainIndex> from older versions
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  <indexConfig>
    <!-- maxFieldLength was removed in 4.0. To get similar behavior, include a 
         LimitTokenCountFilterFactory in your fieldType definition. E.g. 
     <filter class="solr.LimitTokenCountFilterFactory" maxTokenCount="10000"/>
    -->
    <!-- Maximum time to wait for a write lock (ms) for an IndexWriter. Default: 1000 -->
    <!-- <writeLockTimeout>1000</writeLockTimeout>  -->

    <!-- The maximum number of simultaneous threads that may be
         indexing documents at once in IndexWriter; if more than this
         many threads arrive they will wait for others to finish.
         Default in Solr/Lucene is 8. -->
    <!-- <maxIndexingThreads>8</maxIndexingThreads>  -->

    <!-- Expert: Enabling compound file will use less files for the index, 
         using fewer file descriptors on the expense of performance decrease. 
         Default in Lucene is "true". Default in Solr is "false" (since 3.6) -->
    <!-- <useCompoundFile>false</useCompoundFile> -->

    <!-- ramBufferSizeMB sets the amount of RAM that may be used by Lucene
         indexing for buffering added documents and deletions before they are
         flushed to the Directory.
         maxBufferedDocs sets a limit on the number of documents buffered
         before flushing.
         If both ramBufferSizeMB and maxBufferedDocs is set, then
         Lucene will flush based on whichever limit is hit first.  -->
    <!-- <ramBufferSizeMB>100</ramBufferSizeMB> -->
    <!-- <maxBufferedDocs>1000</maxBufferedDocs> -->

    <!-- Expert: Merge Policy 
         The Merge Policy in Lucene controls how merging of segments is done.
         The default since Solr/Lucene 3.3 is TieredMergePolicy.
         The default since Lucene 2.3 was the LogByteSizeMergePolicy,
         Even older versions of Lucene used LogDocMergePolicy.
      -->
    <!--
        <mergePolicy class="org.apache.lucene.index.TieredMergePolicy">
          <int name="maxMergeAtOnce">10</int>
          <int name="segmentsPerTier">10</int>
        </mergePolicy>
      -->
       
    <!-- Merge Factor
         The merge factor controls how many segments will get merged at a time.
         For TieredMergePolicy, mergeFactor is a convenience parameter which
         will set both MaxMergeAtOnce and SegmentsPerTier at once.
         For LogByteSizeMergePolicy, mergeFactor decides how many new segments
         will be allowed before they are merged into one.
         Default is 10 for both merge policies.
      -->
    <!-- 
    <mergeFactor>10</mergeFactor>
      -->

    <!-- Expert: Merge Scheduler
         The Merge Scheduler in Lucene controls how merges are
         performed.  The ConcurrentMergeScheduler (Lucene 2.3 default)
         can perform merges in the background using separate threads.
         The SerialMergeScheduler (Lucene 2.2 default) does not.
     -->
    <!-- 
       <mergeScheduler class="org.apache.lucene.index.ConcurrentMergeScheduler"/>
       -->

    <!-- LockFactory 

         This option specifies which Lucene LockFactory implementation
         to use.
      
         single = SingleInstanceLockFactory - suggested for a
                  read-only index or when there is no possibility of
                  another process trying to modify the index.
         native = NativeFSLockFactory - uses OS native file locking.
                  Do not use when multiple solr webapps in the same
                  JVM are attempting to share a single index.
         simple = SimpleFSLockFactory  - uses a plain file for locking

         Defaults: 'native' is default for Solr3.6 and later, otherwise
                   'simple' is the default

         More details on the nuances of each LockFactory...
         http://wiki.apache.org/lucene-java/AvailableLockFactories
    -->
    <!-- <lockType>native</lockType> -->

    <!-- Unlock On Startup

         If true, unlock any held write or commit locks on startup.
         This defeats the locking mechanism that allows multiple
         processes to safely access a lucene index, and should be used
         with care. Default is "false".

         This is not needed if lock type is 'none' or 'single'
     -->
    <!--
    <unlockOnStartup>false</unlockOnStartup>
      -->
    
    <!-- Expert: Controls how often Lucene loads terms into memory
         Default is 128 and is likely good for most everyone.
      -->
    <!-- <termIndexInterval>128</termIndexInterval> -->

    <!-- If true, IndexReaders will be reopened (often more efficient)
         instead of closed and then opened. Default: true
      -->
    <!-- 
    <reopenReaders>true</reopenReaders>
      -->

    <!-- Commit Deletion Policy

         Custom deletion policies can be specified here. The class must
         implement org.apache.lucene.index.IndexDeletionPolicy.

         http://lucene.apache.org/java/3_5_0/api/core/org/apache/lucene/index/IndexDeletionPolicy.html

         The default Solr IndexDeletionPolicy implementation supports
         deleting index commit points on number of commits, age of
         commit point and optimized status.
         
         The latest commit point should always be preserved regardless
         of the criteria.
    -->
    <!-- 
    <deletionPolicy class="solr.SolrDeletionPolicy">
    -->
      <!-- The number of commit points to be kept -->
      <!-- <str name="maxCommitsToKeep">1</str> -->
      <!-- The number of optimized commit points to be kept -->
      <!-- <str name="maxOptimizedCommitsToKeep">0</str> -->
      <!--
          Delete all commit points once they have reached the given age.
          Supports DateMathParser syntax e.g.
        -->
      <!--
         <str name="maxCommitAge">30MINUTES</str>
         <str name="maxCommitAge">1DAY</str>
      -->
    <!-- 
    </deletionPolicy>
    -->

    <!-- Lucene Infostream
       
         To aid in advanced debugging, Lucene provides an "InfoStream"
         of detailed information when indexing.

         Setting The value to true will instruct the underlying Lucene
         IndexWriter to write its debugging info the specified file
      -->
     <!-- <infoStream file="INFOSTREAM.txt">false</infoStream> --> 
  </indexConfig>

<requestHandler name="/replication" class="solr.ReplicationHandler" >
    <lst name="master">
        <str name="enable">${enable.master:false}</str>
        <str name="replicateAfter">commit</str>
        <str name="replicateAfter">optimize</str>
        <str name="confFiles">schema.xml,solrconfig.xml,protwords.txt,synonyms.txt</str>
    </lst>
    <lst name="slave">
        <str name="enable">${enable.slave:false}</str>
        <str name="masterUrl">${master.url}</str>
        <str name="pollInterval">01:00:00</str>
    </lst>
</requestHandler>

  <updateHandler class="solr.DirectUpdateHandler2" >
    <!-- Solr 4 introduces the Soft Commit option.  Soft Commit is like
         Auto Commit behavior except it enables/ensures that changes are
         visible.  However it does not ensure that data is synced to
         disk.  Of course this is faster and more Near-Realtime friendly -->
    <updateLog>
      <str name="dir">${solr.data.dir:}</str>
    </updateLog>  

    <!-- AutoCommit

         Perform a hard commit automatically under certain conditions.
         Instead of enabling autoCommit, consider using "commitWithin"
         when adding documents. 

         http://wiki.apache.org/solr/UpdateXmlMessages

         maxDocs - Maximum number of documents to add since the last
                   commit before automatically triggering a new commit.

         maxTime - Maximum amount of time in ms that is allowed to pass
                   since a document was added before automaticly
                   triggering a new commit. 
         openSearcher - if false, the commit causes recent index changes
           to be flushed to stable storage, but does not cause a new
           searcher to be opened to make those changes visible.

         If the updateLog is enabled, then it's highly recommended to
         have some sort of hard autoCommit to limit the log size.
      -->
     <autoCommit> 
       <maxTime>120000</maxTime> 
       <openSearcher>false</openSearcher> 
     </autoCommit>

    <!-- softAutoCommit is like autoCommit except it causes a
         'soft' commit which only ensures that changes are visible
         but does not ensure that data is synced to disk.  This is
         faster and more near-realtime friendly than a hard commit.
      -->
     <!--
       <autoSoftCommit> 
         <maxTime>1000</maxTime> 
       </autoSoftCommit>
      -->

    <!-- Update Related Event Listeners
         
         Various IndexWriter related events can trigger Listeners to
         take actions.

         postCommit - fired after every commit or optimize command
         postOptimize - fired after every optimize command
      -->
    <!-- The RunExecutableListener executes an external command from a
         hook such as postCommit or postOptimize.
         
         exe - the name of the executable to run
         dir - dir to use as the current working directory. (default=".")
         wait - the calling thread waits until the executable returns. 
                (default="true")
         args - the arguments to pass to the program.  (default is none)
         env - environment variables to set.  (default is none)
      -->
    <!-- This example shows how RunExecutableListener could be used
         with the script based replication...
         http://wiki.apache.org/solr/CollectionDistribution
      -->
    <!--
       <listener event="postCommit" class="solr.RunExecutableListener">
         <str name="exe">solr/bin/snapshooter</str>
         <str name="dir">.</str>
         <bool name="wait">true</bool>
         <arr name="args"> <str>arg1</str> <str>arg2</str> </arr>
         <arr name="env"> <str>MYVAR=val1</str> </arr>
       </listener>
      -->
  </updateHandler>

  <!-- Once we define ‘updateLog ‘ configuration and it also requires
       a Near-Realtime Handler too -->
  <requestHandler name="/get" class="solr.RealTimeGetHandler">
    <lst name="defaults">
      <str name="omitHeader">true</str>
      <str name="wt">json</str>
      <str name="indent">true</str>
    </lst>
  </requestHandler>

  <!-- query time configurations -->
  <query>
    <maxBooleanClauses>1024</maxBooleanClauses>
    <filterCache class="solr.FastLRUCache"
        size="512" initialSize="512" autowarmCount="128"/>
    <queryResultCache class="solr.LRUCache"
        size="512" initialSize="512" autowarmCount="32"/>
    <documentCache class="solr.LRUCache"
        size="512" initialSize="512" autowarmCount="0"/>
    <enableLazyFieldLoading>true</enableLazyFieldLoading>
    <queryResultWindowSize>50</queryResultWindowSize>
    <queryResultMaxDocsCached>200</queryResultMaxDocsCached>
    <HashDocSet maxSize="3000" loadFactor="0.75"/>

    <!-- a newSearcher event is fired whenever a new searcher is being prepared
      and there is a current searcher handling requests (aka registered).
      It can be used to prime certain caches to prevent long request times for
      certain requests.
    -->
    <!-- QuerySenderListener takes an array of NamedList and executes a
         local query request for each NamedList in sequence. -->
    <listener event="newSearcher" class="solr.QuerySenderListener">
      <arr name="queries">
        <!-- query for all objects (default query) for home page facets -->
        <lst>
          <str name="rows">0</str> 
          <str name="fl">score</str>
          <str name="facet">true</str>
          <str name="facet.mincount">1</str>
          <str name="facet.limit">10</str>
          <str name="facet.field">format</str>
          <str name="facet.field">online</str>
          <str name="facet.field">lc_1letter_facet</str>
          <str name="f.lc_1letter_facet.facet.sort">false</str>
          <str name="facet.field">lc_alpha_facet</str>
          <str name="facet.field">lc_b4cutter_facet</str>
          <str name="facet.field">language_facet</str>
          <str name="facet.field">location_facet</str>
          <str name="facet.field">pub_date_facet</str>
          <str name="facet.field">author_facet</str>
          <str name="facet.field">subject_era_facet</str>
          <str name="facet.field">subject_geo_facet</str>
          <str name="facet.field">subject_topic_facet</str>
          <str name="facet.field">subject_content_facet</str>
        </lst>
        <!-- query for single document to populate filter cache -->
        <lst>
          <str name="q">id:00282214</str>
          <str name="qt">standard</str>
          <str name="rows">0</str>
          <str name="fl">score</str>
          <str name="facet">true</str>
          <str name="facet.mincount">1</str>
          <str name="facet.limit">10</str>
          <str name="facet.field">format</str>
          <str name="facet.field">online</str>
          <str name="facet.field">lc_1letter_facet</str>
          <str name="f.lc_1letter_facet.facet.sort">false</str>
          <str name="facet.field">lc_alpha_facet</str>
          <str name="facet.field">lc_b4cutter_facet</str>
          <str name="facet.field">language_facet</str>
          <str name="facet.field">location_facet</str>
          <str name="facet.field">pub_date_facet</str>
          <str name="facet.field">author_facet</str>
          <str name="facet.field">subject_era_facet</str>
          <str name="facet.field">subject_geo_facet</str>
          <str name="facet.field">subject_topic_facet</str>
          <str name="facet.field">subject_content_facet</str>
        </lst>
      </arr>
    </listener>

    <!-- a firstSearcher event is fired whenever a new searcher is being
         prepared but there is no current registered searcher to handle
         requests or to gain autowarming data from. -->
    <listener event="firstSearcher" class="solr.QuerySenderListener">
      <arr name="queries">
        <!-- query for all objects (default query) for home page facets -->
        <lst>
          <str name="rows">0</str> 
          <str name="fl">score</str>
          <str name="facet">true</str>
          <str name="facet.mincount">1</str>
          <str name="facet.limit">10</str>
          <str name="facet.field">format</str>
          <str name="facet.field">online</str>
          <str name="facet.field">lc_1letter_facet</str>
          <str name="f.lc_1letter_facet.facet.sort">false</str>
          <str name="facet.field">lc_alpha_facet</str>
          <str name="facet.field">lc_b4cutter_facet</str>
          <str name="facet.field">language_facet</str>
          <str name="facet.field">location_facet</str>
          <str name="facet.field">pub_date_facet</str>
          <str name="facet.field">author_facet</str>
          <str name="facet.field">subject_era_facet</str>
          <str name="facet.field">subject_geo_facet</str>
          <str name="facet.field">subject_topic_facet</str>
          <str name="facet.field">subject_content_facet</str>
        </lst>
        <!-- query for single document to populate filter cache -->
        <lst>
          <str name="q">id:00282214</str>
          <str name="qt">standard</str>
          <str name="rows">0</str>
          <str name="fl">score</str>
          <str name="facet">true</str>
          <str name="facet.mincount">1</str>
          <str name="facet.limit">10</str>
          <str name="facet.field">format</str>
          <str name="facet.field">online</str>
          <str name="facet.field">lc_1letter_facet</str>
          <str name="f.lc_1letter_facet.facet.sort">false</str>
          <str name="facet.field">lc_alpha_facet</str>
          <str name="facet.field">lc_b4cutter_facet</str>
          <str name="facet.field">language_facet</str>
          <str name="facet.field">location_facet</str>
          <str name="facet.field">pub_date_facet</str>
          <str name="facet.field">author_facet</str>
          <str name="facet.field">subject_era_facet</str>
          <str name="facet.field">subject_geo_facet</str>
          <str name="facet.field">subject_topic_facet</str>
          <str name="facet.field">subject_content_facet</str>
        </lst>
      </arr>
    </listener>

    <useColdSearcher>false</useColdSearcher>
    <maxWarmingSearchers>2</maxWarmingSearchers>
  </query>

  <requestDispatcher handleSelect="true" >
    <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="2048" />
    <httpCaching lastModifiedFrom="openTime" etagSeed="Solr" />
  </requestDispatcher>

  <!-- blacklight does not use the standard request handler -->
  <requestHandler name="standard" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="echoParams">all</str>
      <str name="q.op">AND</str>
    </lst>
  </requestHandler>
  
  <!-- search handlers to support database ERM interface -->
  <requestHandler name="/databases" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="defType">dismax</str>
      <str name="echoParams">explicit</str>
      <str name="fl">id,fulltitle_display,title_display,subtitle_display,fulltitle_vern_display,summary_display,sixfivethree,url_access_display,dbcode,providercode</str>
      <str name="sort">score desc</str>
      <str name="rows">20</str>
      <str name="wt">ruby</str>
      <str name="q">*</str>
      <str name="q.alt">*</str>
      <str name="facet.mincount">1</str>
      <str name="mm">100%</str>
      <str name="qf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t^12500              title_tP^12500     
        title_t_cjk^2500 
        subtitle_t^5000            subtitle_tP^5000
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t^1250       title_uniform_tP^1250
        title_uniform_t_cjk^250
        title_addl_t^1250          title_addl_tP^1250
        title_addl_t_cjk^250
        title_ngram^1000
        subject_unstemC^375        subject_unstemP^375
        subject_t^250              subject_tP^250
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t^50             publisher_tP^50
        publisher_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t^25          subject_addl_tP^25
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        notes_t                    notes_tP
        notes_t_cjk
        summary_t                  summary_tP
        summary_t_cjk
        toc_t                      toc_tP
        toc_t_cjk
        author_245c_t              author_245c_tP
        author_245c_t_cjk
        barcode_t                  barcode_tP
      </str>
      <str name="pf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t^12500              title_tP^12500     
        title_t_cjk^2500
        subtitle_t^5000            subtitle_tP^5000
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t^1250       title_uniform_tP^1250
        title_uniform_t_cjk^250
        title_addl_t^1250          title_addl_tP^1250
        title_addl_t_cjk^250
        title_ngram^1000
        subject_unstemC^375        subject_unstemP^375
        subject_t^250              subject_tP^250
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t^50             publisher_tP^50
        publisher_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t^25          subject_addl_tP^25
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        notes_t                    notes_tP
        notes_t_cjk
        summary_t                  summary_tP
        summary_t_cjk
        toc_t                      toc_tP
        toc_t_cjk
        author_245c_t              author_245c_tP
        author_245c_t_cjk
        barcode_t                  barcode_tP
      </str>
    </lst>
    <lst name="appends">
      <str name="fq">database_b:true</str>
    </lst>
  </requestHandler>
  <requestHandler name="/database" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="defType">lucene</str>
      <str name="echoParams">explicit</str>
      <str name="fl">id,fulltitle_display,title_display,subtitle_display,fulltitle_vern_display,summary_display,sixfivethree,url_access_display,title_other_display,dbcode,providercode</str>
      <str name="df">id</str>
      <str name="rows">1</str>
      <str name="wt">ruby</str>
      <str name="q">{!raw f=id v=$id}</str>
      <str name="q.alt">*</str>
      <str name="facet.mincount">1</str>
    </lst>
    <lst name="appends">
      <str name="fq">database_b:true</str>
    </lst>
  </requestHandler>
  <requestHandler name="/databasesBySubject" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="defType">lucene</str>
      <str name="echoParams">explicit</str>
      <str name="fl">id,fulltitle_display,title_display,subtitle_display,fulltitle_vern_display,summary_display,sixfivethree,url_access_display,dbcode,providercode</str>
      <str name="df">sixfivethree</str>
      <str name="sort">title_sort asc</str>
      <str name="rows">1000000</str>
      <str name="wt">ruby</str>
      <str name="q">*</str>
      <str name="q.alt">*</str>
      <str name="facet.mincount">1</str>
    </lst>
    <lst name="appends">
      <str name="fq">database_b:true</str>
    </lst>
  </requestHandler>
  <requestHandler name="/databaseAlphaBuckets" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="defType">lucene</str>
      <str name="echoParams">explicit</str>
      <str name="fl">id,fulltitle_display,title_display,subtitle_display,fulltitle_vern_display,summary_display,sixfivethree,url_access_display,dbcode,providercode</str>
      <str name="df">title_1letter_s</str>
      <str name="sort">title_sort asc</str>
      <str name="rows">1000000</str>
      <str name="wt">ruby</str>
      <str name="q">*</str>
      <str name="q.alt">*</str>
      <str name="facet.mincount">1</str>
      <str name="facet.field">title_1letter_s</str>
      <str name="facet.sort">index</str>
    </lst>
    <lst name="appends">
      <str name="fq">database_b:true</str>
    </lst>
  </requestHandler>


  <!-- Searching ("All Fields") -->
  <requestHandler name="search" class="solr.SearchHandler" default="true" >
    <lst name="defaults">
      <str name="defType">edismax</str>
      <str name="echoParams">explicit</str>
      <str name="q.alt">*:*</str>      
      <str name="mm">100%</str>
      <str name="df">title_t</str>
      <str name="qf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t^12500              title_tP^12500     
        title_t_cjk^2500 
        subtitle_t^5000            subtitle_tP^5000
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t^1250       title_uniform_tP^1250
        title_uniform_t_cjk^250
        title_addl_t^1250          title_addl_tP^1250
        title_addl_t_cjk^250
        title_ngram^1000
        subject_unstemC^375        subject_unstemP^375
        subject_t^250              subject_tP^250
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t^50             publisher_tP^50
        publisher_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t^25          subject_addl_tP^25
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        notes_t                    notes_tP
        notes_t_cjk
        summary_t                  summary_tP
        summary_t_cjk
        toc_t                      toc_tP
        toc_t_cjk
        author_245c_t              author_245c_tP
        author_245c_t_cjk
        barcode_t                  barcode_tP
      </str>
      <str name="quot_qf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t_cjk^2500
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t_cjk^250
        title_addl_t_cjk^250
        title_ngram^1000
        subject_unstemC^375        subject_unstemP^375
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t_cjk^10
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t_cjk
        isbn_unstemC               isbn_unstemP
        issn_unstemC               issn_unstemP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_unstemC              donor_unstemP
        donor_t_cjk
        pubplace_unstemC           pubplace_unstemP
        pubplace_t_cjk
        eightninenine_unstemC      eightninenine_unstemP
        eightninenine_t_cjk
        notes_unstemC              notes_unstemP
        notes_t_cjk
        summary_unstemC            summary_unstemP
        summary_t_cjk
        toc_unstemC                toc_unstemP
        toc_t_cjk
        author_245c_unstemC        author_245c_unstemP
        author_245c_t_cjk
        barcode_unstemC            barcode_unstemP
      </str>
      <str name="pf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t^12500              title_tP^12500     
        title_t_cjk^2500
        subtitle_t^5000            subtitle_tP^5000
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t^1250       title_uniform_tP^1250
        title_uniform_t_cjk^250
        title_addl_t^1250          title_addl_tP^1250
        title_addl_t_cjk^250
        title_ngram^1000
        subject_unstemC^375        subject_unstemP^375
        subject_t^250              subject_tP^250
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t^50             publisher_tP^50
        publisher_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t^25          subject_addl_tP^25
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        notes_t                    notes_tP
        notes_t_cjk
        summary_t                  summary_tP
        summary_t_cjk
        toc_t                      toc_tP
        toc_t_cjk
        author_245c_t              author_245c_tP
        author_245c_t_cjk
        barcode_t                  barcode_tP
      </str>
      <str name="quot_pf">
        title_unstemC^25000        title_unstemP^25000
        subtitle_unstemC^12500     subtitle_unstemP^12500
        title_t_cjk^2500
        subtitle_t_cjk^1000
        title_uniform_unstemC^2500 title_uniform_unstemP^2500
        title_addl_unstemC^2500    title_addl_unstemP^2500
        title_uniform_t_cjk^250
        title_addl_t_cjk^250
        subject_unstemC^375        subject_unstemP^375
        subject_t_cjk^50
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t_cjk^10
        lc_callnum_full^100
        publisher_unstemC^75       publisher_unstemP^75
        publisher_t_cjk^10
        author_addl_t_cjk^5
        subject_addl_unstemC^125   subject_addl_unstemP^125
        subject_addl_t_cjk^5
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t_cjk
        isbn_unstemC               isbn_unstemP
        issn_unstemC               issn_unstemP
        isbn_t_cjk
        issn_t_cjk
        donor_s
        donor_unstemC              donor_unstemP
        donor_t_cjk
        pubplace_unstemC           pubplace_unstemP
        pubplace_t_cjk
        eightninenine_unstemC      eightninenine_unstemP
        eightninenine_t_cjk
        notes_unstemC              notes_unstemP
        notes_t_cjk
        summary_unstemC            summary_unstemP
        summary_t_cjk
        toc_unstemC                toc_unstemP
        toc_t_cjk
        author_245c_unstemC        author_245c_unstemP
        author_245c_t_cjk
        barcode_unstemC            barcode_unstemP
      </str>
      
      <str name="author_qf">
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        author_245c_t              author_245c_tP
        author_245c_t_cjk
      </str>
      <str name="author_pf">
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t^50                author_tP^50
        author_t_cjk^10
        author_addl_t^25           author_addl_tP^25
        author_addl_t_cjk^5
        author_245c_t              author_245c_tP
        author_245c_t_cjk
      </str>
      <str name="author_quot_qf">
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t_cjk^10
        author_addl_t_cjk^5
        author_245c_unstemC        author_245c_unstemP
        author_245c_t_cjk
      </str>
      <str name="author_quot_pf">
        author_unstemC^125         author_unstemP^125
        author_addl_unstemC^75     author_addl_unstemP^75
        author_t_cjk^10
        author_addl_t_cjk^5
        author_245c_unstemC        author_245c_unstemP
        author_245c_t_cjk
      </str>


      <str name="title_qf">
        title_unstemC^250          title_unstemP^250
        subtitle_unstemC^125       subtitle_unstemP^125
        title_t^125                title_tP^125   
        title_t_cjk^25
        subtitle_t^50              subtitle_tP^50
        subtitle_t_cjk^10
        title_uniform_unstemC^25   title_uniform_unstemP^25
        title_addl_unstemC^25      title_addl_unstemP^25
        title_uniform_t^12         title_uniform_tP^12
        title_uniform_t_cjk^3
        title_addl_t^12            title_addl_tP^12
        title_addl_t_cjk^3
        title_ngram^10
        title_series_unstemC^3     title_series_unstemP^3
        title_series_t             title_series_t
        title_series_t_cjk   
      </str>
      <str name="title_pf">
        title_unstemC^250          title_unstemP^250
        subtitle_unstemC^125       subtitle_unstemP^125
        title_t^125                title_tP^125   
        title_t_cjk^25
        subtitle_t^50              subtitle_tP^50
        subtitle_t_cjk^10
        title_uniform_unstemC^25   title_uniform_unstemP^25
        title_addl_unstemC^25      title_addl_unstemP^25
        title_uniform_t^12         title_uniform_tP^12
        title_uniform_t_cjk^3
        title_addl_t^12            title_addl_tP^12
        title_addl_t_cjk^3
        title_ngram^10
        title_series_unstemC^3     title_series_unstemP^3
        title_series_t             title_series_t
        title_series_t_cjk   
      </str>
      <str name="title_quot_qf">
        title_unstemC^250          title_unstemP^250
        subtitle_unstemC^125       subtitle_unstemP^125
        title_t_cjk^25
        subtitle_t_cjk^10
        title_uniform_unstemC^25   title_uniform_unstemP^25
        title_addl_unstemC^25      title_addl_unstemP^25
        title_uniform_t_cjk^3
        title_addl_t_cjk^3
        title_series_unstemC^3     title_series_unstemP^3
        title_series_t_cjk   
      </str>
      <str name="title_quot_pf">
        title_unstemC^250          title_unstemP^250
        subtitle_unstemC^125       subtitle_unstemP^125
        title_t_cjk^25
        subtitle_t_cjk^10
        title_uniform_unstemC^25   title_uniform_unstemP^25
        title_addl_unstemC^25      title_addl_unstemP^25
        title_uniform_t_cjk^3
        title_addl_t_cjk^3
        title_series_unstemC^3     title_series_unstemP^3
        title_series_t_cjk   
      </str>

      <str name="subject_qf">
        subject_unstemC^200        subject_unstemP^200
        subject_t^25               subject_tP^25
        subject_t_cjk^5
        subject_addl_unstemC^50    subject_addl_unstemP^50
        subject_addl_t             subject_addl_tP
        subject_addl_t_cjk
      </str>
      <str name="subject_pf">
        subject_unstemC^200        subject_unstemP^200
        subject_t^25               subject_tP^25
        subject_t_cjk^5
        subject_addl_unstemC^50    subject_addl_unstemP^50
        subject_addl_t             subject_addl_tP
        subject_addl_t_cjk
      </str>
      <str name="subject_quot_qf">
        subject_unstemC^200        subject_unstemP^200
        subject_t_cjk^5
        subject_addl_unstemC^50    subject_addl_unstemP^50
        subject_addl_t_cjk
      </str>
      <str name="subject_quot_pf">
        subject_unstemC^200        subject_unstemP^200
        subject_t_cjk^5
        subject_addl_unstemC^50    subject_addl_unstemP^50
        subject_addl_t_cjk
      </str>
      
      <str name="publisher_qf">
        publisher_unstemC^10       publisher_unstemP^10
        publisher_t                publisher_tP
        publisher_t_cjk
      </str>
      <str name="publisher_pf">
        publisher_unstemC^10       publisher_unstemP^10
        publisher_t                publisher_tP
        publisher_t_cjk
      </str>
      <str name="publisher_quot_qf">
        publisher_unstemC^10  publisher_unstemP^10 publisher_t_cjk
      </str>
      <str name="publisher_quot_pf">
        publisher_unstemC^10  publisher_unstemP^10 publisher_t_cjk
      </str>

      <str name="pubplace_qf">
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
      </str>
      <str name="pubplace_pf">
        pubplace_t                 pubplace_tP
        pubplace_t_cjk
      </str>
      <str name="pubplace_quot_qf">
        pubplace_unstemC           pubplace_unstemP
        pubplace_t_cjk
      </str>
      <str name="pubplace_quot_pf">
        pubplace_unstemC           pubplace_unstemP
        pubplace_t_cjk
      </str>
      
      <str name="lc_callnum_qf">
        lc_callnum_full
      </str>
      <str name="lc_callnum_pf">
        lc_callnum_full
      </str>

      <str name="donor_qf">
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
      </str>
      <str name="donor_pf">
        donor_s
        donor_t                    donor_tP
        donor_t_cjk
      </str>
      <str name="donor_quot_qf">
        donor_s
        donor_unstemC              donor_unstemP
        donor_t_cjk
      </str>
      <str name="donor_quot_pf">
        donor_s
        donor_unstemC              donor_unstemP
        donor_t_cjk
      </str>

      <str name="isbnissn_qf">
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
      </str>
      <str name="isbnissn_pf">
        isbn_t                     isbn_tP
        issn_t                     issn_tP
        isbn_t_cjk
        issn_t_cjk
      </str>
      <str name="isbnissn_quot_qf">
        isbn_unstemC               isbn_unstemP
        issn_unstemC               issn_unstemP
        isbn_t_cjk
        issn_t_cjk
      </str>
      <str name="isbnissn_quot_pf">
        isbn_unstemC               isbn_unstemP
        issn_unstemC               issn_unstemP
        isbn_t_cjk
        issn_t_cjk
      </str>
      

      <str name="number_qf">
        id_t                       id_tP
        id_t_cjk
        id
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        barcode_t                  barcode_tP
      </str>
      <str name="number_pf">
        id_t                       id_tP
        id_t_cjk
        id
        eightninenine_t            eightninenine_tP
        eightninenine_t_cjk
        barcode_t                  barcode_tP
      </str>
      <str name="number_quot_qf">
        id_unstemC                 id_unstemP
        id_t_cjk
        id
        eightninenine_unstemC      eightninenine_unstemP
        eightninenine_t_cjk
        barcode_unstemC            barcode_unstemP
      </str>
      <str name="number_quot_pf">
        id_unstemC                 id_unstemP
        id_t_cjk
        id
        eightninenine_unstemC      eightninenine_unstemP
        eightninenine_t_cjk
        barcode_unstemC            barcode_unstemP
      </str>

      <str name="series_qf">
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
      </str>
      <str name="series_pf">
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t^5           title_series_t^5
        title_series_t_cjk
      </str>
      <str name="series_quot_qf">
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t_cjk
      </str>
      <str name="series_quot_pf">
        title_series_unstemC^25    title_series_unstemP^25
        title_series_t_cjk
      </str>
            
      <int name="ps">2</int>
      <float name="tie">0.01</float>

      <str name="fl">
        id, 
        score,
        title_display,
        subtitle_display,
        fulltitle_display,
        fulltitle_vern_display,
        author_display,
        format, 
        online, 
        language_display, 
        pub_info_display,
		pub_date_display,
        pub_date_facet,
		url_access_display,
    	holdings_record_display,
		item_record_display,
		edition_display,
	    title_uniform_display,
	    other_id_display
      </str>
     
      <str name="facet">true</str>
      <str name="facet.mincount">1</str>
      <str name="facet.limit">10</str>
      <str name="facet.field">format</str>
      <str name="facet.field">online</str>
      <str name="facet.field">lc_1letter_facet</str>
      <str name="facet.field">language_facet</str>
      <str name="facet.field">location_facet</str>
      <str name="facet.field">pub_date_facet</str>
      <str name="facet.field">author_facet</str>
      <str name="facet.field">subject_era_facet</str>
      <str name="facet.field">subject_geo_facet</str>
      <str name="facet.field">subject_topic_facet</str>
      <str name="facet.field">subject_content_facet</str>
      
      <str name="spellcheck">true</str>
      <str name="spellcheck.dictionary">default</str>
      <str name="spellcheck.onlyMorePopular">true</str>
      <str name="spellcheck.extendedResults">true</str>
      <str name="spellcheck.collate">false</str>
      <str name="spellcheck.count">5</str>
    </lst>
    <lst name="appends">
      <str name="fq">type:Catalog</str>
      <str name="boost">log(max(10,sub(pub_date_facet,1985)))</str>
    </lst>
    <arr name="last-components">
      <str>spellcheck</str>
    </arr>
    
  </requestHandler>
  
  <!-- for requests to get a single document; use id=666 instead of q=id:666 -->
  <requestHandler name="document" class="solr.SearchHandler" >
    <lst name="defaults">
      <str name="echoParams">all</str>
      <str name="fl">*</str>
      <str name="rows">1</str>
      <str name="q">{!raw f=id v=$id}</str> <!-- use id=666 instead of q=id:666 -->
    </lst>
  </requestHandler>
  
  <!-- for docfreq term counts -->
  <searchComponent name="terms" class="solr.TermsComponent"/>  
  <requestHandler name="/terms" class="solr.SearchHandler" startup="lazy">
  <lst name="defaults">
    <bool name="terms">true</bool>
    <bool name="distrib">false</bool>
  </lst>
  <arr name="components">
    <str>terms</str>
  </arr>
  </requestHandler>
  <requestHandler name="/author" class="solr.SearchHandler" startup="lazy">
    <lst name="defaults">
      <bool name="terms">true</bool>
      <bool name="distrib">false</bool>
      <str name="terms.sort">index</str>
      <str name="terms.limit">60</str>
      <bool name="terms.upper.incl">true</bool>
      <str name="terms.fl">author_facet</str>
    </lst>
    <arr name="components">
      <str>terms</str>
    </arr>
  </requestHandler>
  <requestHandler name="/subject" class="solr.SearchHandler" startup="lazy">
    <lst name="defaults">
      <bool name="terms">true</bool>
      <bool name="distrib">false</bool>
      <str name="terms.sort">index</str>
      <str name="terms.limit">60</str>
      <bool name="terms.upper.incl">true</bool>
      <str name="terms.fl">subject_topic_facet</str>
    </lst>
    <arr name="components">
      <str>terms</str>
    </arr>
  </requestHandler>

  <searchComponent name="spellcheck" class="solr.SpellCheckComponent">
    <str name="queryAnalyzerFieldType">textSpell</str>
    <lst name="spellchecker">
      <str name="name">default</str>
      <str name="field">spell</str>
      <str name="spellcheckIndexDir">./spell</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">author</str>
      <str name="field">author_spell</str>
      <str name="spellcheckIndexDir">./spell_author</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">subject</str>
      <str name="field">subject_spell</str>
      <str name="spellcheckIndexDir">./spell_subject</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">title</str>
      <str name="field">title_spell</str>
      <str name="spellcheckIndexDir">./spell_title</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
  </searchComponent>

  <requestHandler name="/update" class="solr.UpdateRequestHandler" />
  <requestHandler name="/update/javabin" class="solr.UpdateRequestHandler" />

<!-- this caused a problem with solr 4.1 -->
<!--  <requestHandler name="/analysis" class="solr.AnalysisRequestHandler" /> -->

  <requestHandler name="/admin/" class="org.apache.solr.handler.admin.AdminHandlers" />
  <requestHandler name="/admin/ping" class="PingRequestHandler">
    <lst name="defaults">
      <str name="qt">search</str>
      <str name="q">book</str>
      <str name="echoParams">all</str>
    </lst>
  </requestHandler>
  <admin>
    <defaultQuery>book</defaultQuery>
  </admin>

  <requestHandler name="/debug/dump" class="solr.DumpRequestHandler" >
    <lst name="defaults">
     <str name="echoParams">explicit</str>
     <str name="echoHandler">true</str>
    </lst>
  </requestHandler>

  <!-- used for admin analysis tool -->
  <requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" />
</config>
